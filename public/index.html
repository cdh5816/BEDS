<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>BEDS v2 - Building Earthquake Detection System</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <link rel="stylesheet" href="/style.css" />
  </head>
  <body>
    <div id="app">
      <header class="beds-header">
        <div class="beds-header-left">
          <div class="beds-logo">BEDS</div>
          <div class="beds-subtitle">Building Earthquake Detection System</div>
        </div>
        <div class="beds-header-right">
          <div id="beds-role-badge" class="beds-role-badge hidden"></div>
          <button id="beds-login-button" class="beds-button primary">
            로그인
          </button>
          <button id="beds-logout-button" class="beds-button subtle hidden">
            로그아웃
          </button>
        </div>
      </header>
      <main class="beds-layout">
        <section class="beds-layout-main">
          <section class="beds-card beds-map-card">
            <div class="beds-card-header">
              <div>
                <h2>모니터링 현장 지도</h2>
                <p class="hint">
                  BEDS가 관리 중인 건물 위치를 한눈에 볼 수 있습니다.
                  (로그인 없이도 공개 조회)
                </p>
              </div>
            </div>
            <div id="beds-map"></div>
          </section>
          <section id="beds-public-list" class="beds-card beds-public-list">
            <div class="beds-card-header">
              <h3>등록된 현장 목록</h3>
            </div>
            <div id="beds-public-sites-container" class="sites-list"></div>
          </section>
        </section>
        <aside class="beds-layout-side">
          <section id="beds-admin-panel" class="beds-card hidden">
            <div class="beds-card-header">
              <h2>관리자 패널</h2>
              <p class="hint">
                현장을 등록하고, 카카오 주소 검색으로 좌표를 자동으로 채울 수 있습니다.
              </p>
            </div>
            <div class="beds-tabs">
              <button
                id="beds-admin-tab-sites"
                class="beds-tab-button active"
                data-tab="sites"
              >
                현장 등록
              </button>
              <button
                id="beds-admin-tab-list"
                class="beds-tab-button"
                data-tab="list"
              >
                현장 리스트
              </button>
            </div>
            <div id="beds-admin-tab-content-sites" class="beds-tab-content active">
              <form id="beds-site-form" class="beds-form">
                <div class="beds-form-row">
                  <label for="site-name">현장 이름</label>
                  <input id="site-name" type="text" required />
                </div>
                <div class="beds-form-row">
                  <label for="site-address">주소</label>
                  <div class="beds-input-with-button">
                    <input id="site-address" type="text" required />
                    <button
                      type="button"
                      id="beds-address-search-button"
                      class="beds-button subtle"
                    >
                      주소 검색
                    </button>
                  </div>
                  <p class="hint small">
                    Kakao REST API 키가 설정된 경우, 주소를 좌표로 변환합니다.
                  </p>
                </div>
                <div class="beds-form-row-inline">
                  <div>
                    <label for="site-lat">위도 (lat)</label>
                    <input id="site-lat" type="number" step="0.000001" required />
                  </div>
                  <div>
                    <label for="site-lng">경도 (lng)</label>
                    <input id="site-lng" type="number" step="0.000001" required />
                  </div>
                </div>
                <button type="submit" class="beds-button primary full">
                  현장 등록
                </button>
              </form>
            </div>
            <div id="beds-admin-tab-content-list" class="beds-tab-content">
              <div id="beds-admin-sites-list" class="sites-list small"></div>
            </div>
          </section>
          <section id="beds-customer-panel" class="beds-card hidden">
            <div class="beds-card-header">
              <h2>내 건물 실시간 상태</h2>
              <p class="hint">
                고객 계정으로 로그인하면, 연결된 현장의 현재 흔들림/휨 상태를
                실시간으로 확인할 수 있습니다.
              </p>
            </div>
            <div class="beds-form-row">
              <label for="customer-site-select">내 현장 선택</label>
              <select id="customer-site-select"></select>
            </div>
            <div id="beds-connection-alert" class="beds-connection-alert hidden">
              ⚠ 센서 신호가 일정 시간 이상 수신되지 않았습니다.
            </div>
            <div id="beds-customer-status" class="status-grid">
              <div class="status-card">
                <div class="label">현재 흔들림</div>
                <div id="status-shake" class="value">-</div>
                <div class="unit">g</div>
              </div>
              <div class="status-card">
                <div class="label">현재 휨 정도</div>
                <div id="status-bending" class="value">-</div>
                <div class="unit">상대값</div>
              </div>
              <div class="status-card">
                <div class="label">센서 수</div>
                <div id="status-sensor-count" class="value">-</div>
                <div class="unit">개</div>
              </div>
            </div>
            <div class="beds-card-sub">
              <div class="beds-card-header">
                <h3>최근 데이터 타임라인</h3>
              </div>
              <div id="beds-measurements-timeline" class="timeline"></div>
            </div>
          </section>
        </aside>
      </main>
      <div id="beds-login-modal" class="beds-modal hidden">
        <div class="beds-modal-backdrop"></div>
        <div class="beds-modal-content">
          <h2>BEDS 로그인</h2>
          <form id="beds-login-form" class="beds-form">
            <div class="beds-form-row">
              <label for="login-email">이메일</label>
              <input id="login-email" type="email" required />
            </div>
            <div class="beds-form-row">
              <label for="login-password">비밀번호</label>
              <input id="login-password" type="password" required />
            </div>
            <button type="submit" class="beds-button primary full">로그인</button>
          </form>
          <button id="beds-modal-close" class="beds-button subtle full">
            닫기
          </button>
        </div>
      </div>
    </div>
    <script src="/config.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="/app.js"></script>
  </body>
</html>
